function [xdot]=LeftLeg(x,th,ths,time,kpid)

% my dynamic calculation symbolic program th1 (Yaw), th2 (Pitch), th3 (Pitch), th4 (Pitch), th5 (Yaw)
% my original Ditch Program                            th1 (Yaw), th2 (Pitch), th3 (Pitch), th15 (Pitch), th5 (Yaw)
% Ravi sir original Flat Program                        th2 (Yaw). th3 (Pitch), th4 (Pitch), th6 (Pitch), th5 (Yaw)
% I am replacing, th4 (Pitch, my dynamic calculation symbolic program) with th15 (Pitch in my original Ditch Program)
% and using the properties of th6 (Pitch, in Ravi Sir original Flat Program) in and as th15

cth1=th(1:8);
cth2=th(9:16);
cth3=th(17:24);
cth15=th(25:32);
cth4=th(33:40);

th1s=ths(1);
th2s=ths(2);
th3s=ths(3);
th15s=ths(4);
th4s=ths(5);

global l1; global l2; global l3; global l15; global l4;
global m1; global m2; global m3; global m15; global m4;

t21=[0 0 0 0 0 0 0 0];
t22=[0 0 0 0 0 0 0 0];
t23=[0 0 0 0 0 0 0 0];
t215=[0 0 0 0 0 0 0 0];
t24=[0 0 0 0 0 0 0 0];

for p=1:8

  th15=cth15(p);
  t215(p)=th15;

  th4=(pi/2)-cth4(p);
  t24(p)=th4;

  th3=(pi/2)-cth3(p);
  t23(p)=th3;

  th2=cth3(p)-cth2(p);
  t22(p)=th2;

  th1=(pi/2)-cth1(p);
  t21(p)=th1;
  
  [comega1, calpha1]=differential(t21,time);
  [comega2, calpha2]=differential(t22,time);
  [comega3, calpha3]=differential(t23,time);
  [comega15, calpha15]=differential(t215,time);
  [comega4, calpha4]=differential(t24,time);
  
  omega1(1)=-comega1(p);
  alpha1(1)=-calpha1(p);
  
  omega1(2)=comega3(p)-comega2(p);
  alpha1(2)=calpha3(p)-calpha2(p);

  omega1(3)=-comega3(p);
  alpha1(3)=-calpha3(p);
  
  omega1(4)=-comega4(p);
  alpha1(4)=-calpha4(p);
  
  omega1(15)=comega15(p);
  alpha1(15)=calpha15(p);
  
end

%% Step-1
% Making Configuration Diagram in home position, assigning the frames, determining the T34-H parameters for each links
% and then identifying the basic transformation matrix 0T1, 1T2, 2T3, 3T4, 4T5

%% Step-2
% Computation of Transformation Matrix 0T5
% Initial Transformation Matrix T01 = 0T1, T12 = 1T2, T23 = 2T3, T34 = 3T4, T45 = 4T5

T01 = [cos(th1) 0 sin(th1) l1*cos(th1);sin(th1) 0 -cos(th1) l1*sin(th1);0 1 0 0;0 0 0 1];
T12 = [cos(th2) -sin(th2) 0 l2*cos(th2);sin(th2) cos(th2) 0 l2*sin(th2);0 0 1 0;0 0 0 1];
T23 = [cos(th3) -sin(th3) 0 l3*cos(th3);sin(th3) cos(th3) 0 l3*sin(th3);0 0 1 0;0 0 0 1];
T34 = [cos(th15) 0 -sin(th15) l15*cos(th15);sin(th15) 0 cos(th15) l15*sin(th15);0 -1 0 0;0 0 0 1];
T45 = [cos(th4) -sin(th4) 0 l4*cos(th4);sin(th4) cos(th4) 0 l4*sin(th4);0 0 1 0;0 0 0 1];

% Other Transformation Matrix
% T00 = 0T0 = 1T1 = 2T2 = 3T3 = 4T4 = 5T5
% eye command is for identity matrix of (n,m) order

T00 = eye(4,4);

% T01 = 0T1, T02 = 0T2, T03 = 0T3, T04 = 0T4, T05 = 0T5, T13 = 1T3, T14 = 1T4, T24 = 2T4 

T02 = T01*T12;
T03 = T01*T12*T23;
T04 = T01*T12*T23*T34;
T05 = T01*T12*T23*T34*T45;
T13 = T12*T23;
T14 = T12*T23*T34;
T15 = T12*T23*T34*T45;
T24 = T23*T34;
T25 = T23*T34*T45;
T35 = T34*T45;

% T21 = inv(T12); T31 = inv(T13); T32 = inv(T23); T41 = inv(T14); T42 = inv(T24);
% T43 = inv(T34); T51 = inv(T15); T52 = inv(T25); T53 = inv(T35); T54 = inv(T45);

%% Step-3
% Joint Variables Q terms, since all are the revolute joint, having the same value

Q5 = [0 -1 0 0;1 0 0 0;0 0 0 0;0 0 0 0]; Q4 = Q5; Q3 = Q4; Q2 = Q3; Q1 = Q2;

%% Step-4
% Inertia Tensors for each link having mass at the cenroid of the link

I1 = [1/3*m1*l1^2 0 0 -1/2*m1*l1;0 0 0 0;0 0 0 0;-1/2*m1*l1 0 0 m1];
I2 = [1/3*m2*l2^2 0 0 -1/2*m2*l2;0 0 0 0;0 0 0 0;-1/2*m2*l2 0 0 m2];
I3 = [1/3*m3*l3^2 0 0 -1/2*m3*l3;0 0 0 0;0 0 0 0;-1/2*m3*l3 0 0 m3];
I15 = [1/3*m15*l15^2 0 0 -1/2*m15*l15;0 0 0 0;0 0 0 0;-1/2*m15*l15 0 0 m15];
I4 = [1/3*m4*l4^2 0 0 -1/2*m4*l4;0 0 0 0;0 0 0 0;-1/2*m4*l4 0 0 m4];

%% Step-5
% Computation of Matrices Dij

d11 = T00*Q1*T01;
% d12 = 0; d13 = 0; d14 = 0; d15 = 0;
d21 = T00*Q1*T02;
d22 = T01*Q2*T12;
% d23 = 0; d24 = 0; d25 = 0;
d31 = T00*Q1*T03;
d32 = T01*Q2*T13;
d33 = T02*Q3*T23;
% d34 = 0; d35 = 0;
d41 = T00*Q1*T04;
d42 = T01*Q2*T14;
d43 = T02*Q3*T24;
d44 = T03*Q4*T34;
% d45 = 0;
d51 = T00*Q1*T05;
d52 = T01*Q2*T15;
d53 = T02*Q3*T25;
d54 = T03*Q4*T35;
d55 = T04*Q5*T45;

%% Step-6
% Computing the element of Inertia Matrix Mij

M11 = trace(d11*I1*d11') + trace(d21*I2*d21') + trace(d31*I3*d31') + trace(d41*I15*d41')+ trace(d51*I4*d51');
M12 = trace(d22*I2*d21') + trace(d32*I3*d31') + trace(d42*I15*d41') + trace(d52*I4*d51');
M13 = trace(d33*I3*d31') + trace(d43*I15*d41') + trace(d53*I4*d51');
M14 = trace(d44*I15*d41') + trace(d54*I4*d51');
M15 = trace(d55*I4*d51');

M21 = trace(d21*I2*d22') + trace(d31*I3*d32') + trace(d41*I15*d42') + trace(d51*I4*d52');
M22 = trace(d22*I2*d22') + trace(d32*I3*d32') + trace(d42*I15*d42') + trace(d52*I4*d52');
M23 = trace(d33*I3*d32') + trace(d43*I15*d42') + trace(d53*I4*d52');
M24 = trace(d44*I15*d42') + trace(d54*I4*d52');
M25 = trace(d55*I4*d52');

M31 = trace(d31*I3*d33') + trace(d41*I15*d43') + trace(d51*I4*d53');
M32 = trace(d32*I3*d33') + trace(d42*I15*d43') + trace(d52*I4*d53');
M33 = trace(d33*I3*d33') + trace(d43*I15*d43') + trace(d53*I4*d53');
M34 = trace(d44*I15*d43') + trace(d54*I4*d53');
M35 = trace(d55*I4*d53');

M41 = trace(d41*I15*d44') + trace(d51*I4*d54');
M42 = trace(d42*I15*d44') + trace(d52*I4*d54');
M43 = trace(d43*I15*d44') + trace(d53*I4*d54');
M44 = trace(d44*I15*d44') + trace(d54*I4*d54');
M45 = trace(d55*I4*d54');

M51 = trace(d51*I4*d55');
M52 = trace(d52*I4*d55');
M53 = trace(d53*I4*d55');
M54 = trace(d54*I4*d55');
M55 = trace(d55*I4*d55');
M = [M11 M12 M13 M14 M15; M21 M22 M23 M24 M25; M31 M32 M33 M34 M35; M41 M42 M43 M44 M45; M51 M52 M53 M54 M55];

%% Step-7
% Computing the Dijk, differentiation of Dij wrt Qk (joint variable th1, th2, th3, th15, th4)

d111=[-cos(conj(th1)), 0, -sin(conj(th1)), -cos(conj(th1))*conj(l1);-sin(conj(th1)), 0,  cos(conj(th1)), -sin(conj(th1))*conj(l1);0, 0, 0, 0;0, 0, 0, 0];
% d112=zeros(4,4); d113=zeros(4,4); d114=zeros(4,4); d115=zeros(4,4);
% d121=zeros(4,4); d122=zeros(4,4); d123=zeros(4,4); d124=zeros(4,4); d125=zeros(4,4);
% d131=zeros(4,4); d132=zeros(4,4); d133=zeros(4,4); d134=zeros(4,4); d135=zeros(4,4);
% d141=zeros(4,4); d142=zeros(4,4); d143=zeros(4,4); d144=zeros(4,4); d145=zeros(4,4);
% d151=zeros(4,4); d152=zeros(4,4); d153=zeros(4,4); d154=zeros(4,4); d155=zeros(4,4);

d211=[-cos(conj(th1))*cos(conj(th2)), cos(conj(th1))*sin(conj(th2)), -sin(conj(th1)), - cos(conj(th1))*conj(l1) - cos(conj(th1))*cos(conj(th2))*conj(l2);-cos(conj(th2))*sin(conj(th1)), sin(conj(th1))*sin(conj(th2)),  cos(conj(th1)), - sin(conj(th1))*conj(l1) - cos(conj(th2))*sin(conj(th1))*conj(l2);0,0,0,0;0,0,0,0];
d212=[sin(conj(th1))*sin(conj(th2)),  cos(conj(th2))*sin(conj(th1)), 0,  sin(conj(th1))*sin(conj(th2))*conj(l2);-cos(conj(th1))*sin(conj(th2)), -cos(conj(th1))*cos(conj(th2)), 0, -cos(conj(th1))*sin(conj(th2))*conj(l2);0,0,0,0;0,0,0,0];

% d213=zeros(4,4); d214=zeros(4,4); d215=zeros(4,4);

d221=[sin(conj(th1))*sin(conj(th2)), cos(conj(th2))*sin(conj(th1)), 0,  sin(conj(th1))*sin(conj(th2))*conj(l2);-cos(conj(th1))*sin(conj(th2)), -cos(conj(th1))*cos(conj(th2)), 0, -cos(conj(th1))*sin(conj(th2))*conj(l2);0,0,0,0;0,0,0,0];
d222=[-cos(conj(th1))*cos(conj(th2)), cos(conj(th1))*sin(conj(th2)), 0, -cos(conj(th1))*cos(conj(th2))*conj(l2);-cos(conj(th2))*sin(conj(th1)), sin(conj(th1))*sin(conj(th2)), 0, -cos(conj(th2))*sin(conj(th1))*conj(l2);-sin(conj(th2)), -cos(conj(th2)), 0, -sin(conj(th2))*conj(l2);0,0,0,0];

% d223=zeros(4,4); d224=zeros(4,4); d225=zeros(4,4);
% d231=zeros(4,4); d232=zeros(4,4); d233=zeros(4,4); d234=zeros(4,4); d235=zeros(4,4);
% d241=zeros(4,4); d242=zeros(4,4); d243=zeros(4,4); d244=zeros(4,4); d245=zeros(4,4);

d311=[cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), -sin(conj(th1)), cos(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th2))*conj(l2) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3))*conj(l3) - cos(conj(th1))*conj(l1);sin(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1)), cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)),  cos(conj(th1)), sin(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th2))*sin(conj(th1))*conj(l2) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1))*conj(l3) - sin(conj(th1))*conj(l1);0,0,0,0;0,0,0,0];
d312=[cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)), cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)), 0,   sin(conj(th1))*sin(conj(th2))*conj(l2) + cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3);- cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), 0, - cos(conj(th1))*sin(conj(th2))*conj(l2) - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d313=[cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)), cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)), 0,   cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3);- cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), 0, - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];

% d314=zeros(4,4); d315=zeros(4,4);

d321=[sin(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))),  sin(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,  sin(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3));-cos(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))), -cos(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0, -cos(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3));0,0,0,0;0,0,0,0];
d322=[-cos(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), cos(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))), 0, -cos(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th2))*sin(conj(th3))*conj(l3));-sin(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), sin(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))), 0, -sin(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th2))*sin(conj(th3))*conj(l3));- cos(conj(th2))*sin(conj(th3)) - cos(conj(th3))*sin(conj(th2)),                  sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3)), 0,                 - sin(conj(th2))*conj(l2) - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d323=[-cos(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), cos(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))), 0, -cos(conj(th1))*(cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th2))*sin(conj(th3))*conj(l3));-sin(conj(th1))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), sin(conj(th1))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))), 0, -sin(conj(th1))*(cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th2))*sin(conj(th3))*conj(l3));- cos(conj(th2))*sin(conj(th3)) - cos(conj(th3))*sin(conj(th2)),                  sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3)), 0,                 - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];

% d324=zeros(4,4); d325=zeros(4,4);

d331=[cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)), cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)), 0,   cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3);- cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), 0, - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d332=[cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), 0, cos(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3))*conj(l3); sin(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1)), cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)), 0, sin(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1))*conj(l3); - cos(conj(th2))*sin(conj(th3)) - cos(conj(th3))*sin(conj(th2)),                               sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3)), 0,                             - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d333=[cos(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3)), cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)), 0, cos(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3))*conj(l3); sin(conj(th1))*sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1)), cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)), 0, sin(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1))*conj(l3); - cos(conj(th2))*sin(conj(th3)) - cos(conj(th3))*sin(conj(th2)),                               sin(conj(th2))*sin(conj(th3)) - cos(conj(th2))*cos(conj(th3)), 0,                             - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];

% d334=zeros(4,4); d335=zeros(4,4);
% d341=zeros(4,4); d342=zeros(4,4); d343=zeros(4,4); d344=zeros(4,4); d345=zeros(4,4);
% d351=zeros(4,4); d352=zeros(4,4); d353=zeros(4,4); d354=zeros(4,4); d355=zeros(4,4);

d411=[sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))),  sin(conj(th1)), cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th1))*cos(conj(th2))*conj(l2) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - cos(conj(th1))*conj(l1) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3))*conj(l3) + cos(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3); sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), -cos(conj(th1)), cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th1))*conj(l1) - cos(conj(th2))*sin(conj(th1))*conj(l2) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1))*conj(l3) + sin(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3);0,0,0,0;0,0,0,0];
d412=[cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*conj(l2) + cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3); - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th1))*sin(conj(th2))*conj(l2) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d413=[cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3); - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d414=[cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)));0,0,0,0;0,0,0,0];

% d415=zeros(4,4);

d421=[sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), 0,  sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),  sin(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3)); -cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), 0, -cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), -cos(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3));0,0,0,0;0,0,0,0];
d422=[-cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - sin(conj(th2))*conj(l2) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d423=[-cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d424=[-cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))); -sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0, sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];

% d425=zeros(4,4);

d431=[cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))),   cos(conj(th2))*sin(conj(th1))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), - cos(conj(th1))*cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0;0,0,0,0];
d432=[cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0,                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];
d433=[cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0,                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];
d434=[cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0,                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];

% d435=zeros(4,4);

d441=[cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)));0,0,0,0;0,0,0,0];
d442=[sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];
d443=[sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];
d444=[sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];

% d445=zeros(4,4);
% d451=zeros(4,4); d452=zeros(4,4); d453=zeros(4,4); d454=zeros(4,4); d455=zeros(4,4);

d511=[sin(conj(th1))*sin(conj(th4)) - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))), sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) + cos(conj(th4))*sin(conj(th1)), cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th1))*sin(conj(th4))*conj(l4) - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th2))*conj(l2) - cos(conj(th1))*conj(l1) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) + sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th1))*cos(conj(th2))*cos(conj(th3))*conj(l3) + cos(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3); - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*sin(conj(th4)), sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4)), cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th1))*conj(l1) - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th2))*sin(conj(th1))*conj(l2) - cos(conj(th1))*sin(conj(th4))*conj(l4) - cos(conj(th2))*cos(conj(th3))*sin(conj(th1))*conj(l3) + sin(conj(th1))*sin(conj(th2))*sin(conj(th3))*conj(l3);0,0,0,0;0,0,0,0];
d512=[cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))) + sin(conj(th1))*sin(conj(th2))*conj(l2) + cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))),  sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))) - cos(conj(th1))*sin(conj(th2))*conj(l2) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d513=[cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))) + cos(conj(th2))*sin(conj(th1))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))*conj(l3); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))),  sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th1))*cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0;0,0,0,0];
d514=[cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))),  sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))) - cos(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)));0,0,0,0;0,0,0,0];
d515=[sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4)), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) + cos(conj(th1))*sin(conj(th4)), 0,   sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4))*conj(l4); - sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) - cos(conj(th4))*sin(conj(th1)), sin(conj(th1))*sin(conj(th4)) - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))), 0, - sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) - cos(conj(th4))*sin(conj(th1))*conj(l4);0,0,0,0;0,0,0,0];
d521=[cos(conj(th4))*sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),  sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),  sin(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3)); -cos(conj(th1))*cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),  cos(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), -cos(conj(th1))*(sin(conj(th2))*conj(l2) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*sin(conj(th3))*conj(l3) + cos(conj(th3))*sin(conj(th2))*conj(l3));0,0,0,0;0,0,0,0];
d522=[-cos(conj(th1))*cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -cos(conj(th4))*sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th2))*conj(l2) + cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - sin(conj(th2))*conj(l2) - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d523=[-cos(conj(th1))*cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -cos(conj(th4))*sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) + cos(conj(th2))*cos(conj(th3))*conj(l3) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th2))*sin(conj(th3))*conj(l3)); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th3))*conj(l3) - cos(conj(th3))*sin(conj(th2))*conj(l3);0,0,0,0];
d524=[-cos(conj(th1))*cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), cos(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -cos(conj(th1))*(cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))); -cos(conj(th4))*sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), -sin(conj(th1))*(cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))) + cos(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                  sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                 - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))) - cos(conj(th15))*conj(l15)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - sin(conj(th15))*conj(l15)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];
d525=[cos(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), cos(conj(th1))*cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), 0, cos(conj(th1))*sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))); sin(conj(th1))*sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*sin(conj(th1))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th1))*sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))); -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),               -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0,               -sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))));0,0,0,0];
d531=[cos(conj(th2))*cos(conj(th4))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th4))*sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), - cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))),   cos(conj(th2))*sin(conj(th1))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th1))*cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),   cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), - cos(conj(th1))*cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0;0,0,0,0];
d532=[cos(conj(th1))*cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); cos(conj(th4))*sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*cos(conj(th4))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];
d533=[cos(conj(th1))*cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); cos(conj(th4))*sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*cos(conj(th4))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(sin(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th3))*conj(l3) + cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];
d534=[cos(conj(th1))*cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th1))*cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th1))*cos(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*sin(conj(th2))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th1))*cos(conj(th2))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); cos(conj(th4))*sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*cos(conj(th4))*sin(conj(th1))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) - sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))), cos(conj(th2))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), sin(conj(th1))*sin(conj(th2))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - cos(conj(th2))*sin(conj(th1))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15)); - cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                             - cos(conj(th2))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th3))*sin(conj(th15))*conj(l15) + cos(conj(th15))*sin(conj(th3))*conj(l15)) - sin(conj(th2))*(cos(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th3))*cos(conj(th15))*conj(l15) - sin(conj(th3))*sin(conj(th15))*conj(l15));0,0,0,0];
d535=[cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th1))*cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th1))*cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th1))*sin(conj(th2))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) + cos(conj(th1))*cos(conj(th2))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))); cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), cos(conj(th2))*cos(conj(th4))*sin(conj(th1))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + cos(conj(th4))*sin(conj(th1))*sin(conj(th2))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0, cos(conj(th2))*sin(conj(th1))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) + sin(conj(th1))*sin(conj(th2))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))) ; sin(conj(th2))*sin(conj(th4))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))),                               cos(conj(th4))*sin(conj(th2))*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*cos(conj(th4))*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15))), 0,                               sin(conj(th2))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*sin(conj(th15)) + cos(conj(th15))*sin(conj(th3))) - cos(conj(th2))*sin(conj(th4))*conj(l4)*(cos(conj(th3))*cos(conj(th15)) - sin(conj(th3))*sin(conj(th15)));0,0,0,0];
d541=[cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), - cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))),   (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*cos(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th4))*sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))),   cos(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)));0,0,0,0;0,0,0,0];
d542=[cos(conj(th4))*sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - (cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))*(cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4)) - (cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))*(sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4));0,0,0,0];
d543=[cos(conj(th4))*sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - (cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))*(cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4)) - (cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))*(sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4));0,0,0,0];
d544=[cos(conj(th4))*sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))), cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), (sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) - (cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                           - (cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))*(cos(conj(th15))*conj(l15) + cos(conj(th15))*cos(conj(th4))*conj(l4)) - (cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))*(sin(conj(th15))*conj(l15) + cos(conj(th4))*sin(conj(th15))*conj(l4));0,0,0,0];
d545=[cos(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*cos(conj(th4))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + cos(conj(th4))*sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))); cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))), 0, cos(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))); sin(conj(th15))*sin(conj(th4))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*sin(conj(th4))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))),                                                             cos(conj(th4))*sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*cos(conj(th4))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))), 0,                                                             sin(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) - cos(conj(th15))*sin(conj(th4))*conj(l4)*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)));0,0,0,0];
d551=[sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4)), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) + cos(conj(th1))*sin(conj(th4)), 0,   sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4))*conj(l4);- sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) - cos(conj(th4))*sin(conj(th1)), sin(conj(th1))*sin(conj(th4)) - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))), 0, - sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) - cos(conj(th4))*sin(conj(th1))*conj(l4);0,0,0,0;0,0,0,0];
d552=[sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))); sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))); -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),                                                            -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0,                                                            -sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))));0,0,0,0];
d553=[sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))); sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))); -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),                                                            -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0,                                                            -sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))));0,0,0,0];
d554=[sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3)))); sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))), 0, sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3)))); -sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))),                                                            -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2)))), 0,                                                            -sin(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))));0,0,0,0];
d555=[sin(conj(th1))*sin(conj(th4)) - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))), sin(conj(th4))*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))) + cos(conj(th4))*sin(conj(th1)), 0,   sin(conj(th1))*sin(conj(th4))*conj(l4) - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th1))*cos(conj(th2))*cos(conj(th3)) - cos(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th1))*cos(conj(th2))*sin(conj(th3)) + cos(conj(th1))*cos(conj(th3))*sin(conj(th2)))); - cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*sin(conj(th4)), sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*cos(conj(th4)), 0, - cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*cos(conj(th3))*sin(conj(th1)) - sin(conj(th1))*sin(conj(th2))*sin(conj(th3))) - sin(conj(th15))*(cos(conj(th2))*sin(conj(th1))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th1))*sin(conj(th2)))) - cos(conj(th1))*sin(conj(th4))*conj(l4); -cos(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))),                                                                                             sin(conj(th4))*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3)))), 0,                                                                                                       -cos(conj(th4))*conj(l4)*(cos(conj(th15))*(cos(conj(th2))*sin(conj(th3)) + cos(conj(th3))*sin(conj(th2))) + sin(conj(th15))*(cos(conj(th2))*cos(conj(th3)) - sin(conj(th2))*sin(conj(th3))));0,0,0,0];

%% Step-8
% Computing the Coriolis and Centrifugal Force Coefficients or Velocity Coupling Coefficients Hijk

% For Joint 1
h111 = trace(d111*I1*d11') + trace(d211*I2*d21') + trace(d311*I3*d31') + trace(d411*I15*d41')+ trace(d511*I4*d51');
h112 = trace(d212*I2*d21') + trace(d312*I3*d31') + trace(d412*I15*d41') + trace(d512*I4*d51');
h113 = trace(d313*I3*d31') + trace(d413*I15*d41') + trace(d513*I4*d51');
h114 = trace(d414*I15*d41') + trace(d514*I4*d51');
h115 = trace(d515*I4*d51');

h121 = trace(d221*I2*d21') + trace(d321*I3*d31') + trace(d421*I15*d41') + trace(d521*I4*d51');
h122 = trace(d222*I2*d21') + trace(d322*I3*d31') + trace(d422*I15*d41') + trace(d522*I4*d51');
h123 = trace(d323*I3*d31') + trace(d423*I15*d41') + trace(d523*I4*d51');
h124 = trace(d424*I15*d41') + trace(d524*I4*d51');
h125 = trace(d525*I4*d51');

h131 = trace(d331*I3*d31') + trace(d431*I15*d41') + trace(d531*I4*d51');
h132 = trace(d332*I3*d31') + trace(d432*I15*d41') + trace(d532*I4*d51');
h133 = trace(d333*I3*d31') + trace(d433*I15*d41') + trace(d533*I4*d51');
h134 = trace(d434*I15*d41') + trace(d534*I4*d51');
h135 = trace(d535*I4*d51');

h141 = trace(d441*I15*d41') + trace(d541*I4*d41');
h142 = trace(d442*I15*d41') + trace(d542*I4*d51');
h143 = trace(d443*I15*d41') + trace(d543*I4*d51');
h144 = trace(d444*I15*d41') + trace(d544*I4*d51');
h145 = trace(d545*I4*d51');

h151 = trace(d551*I4*d51');
h152 = trace(d552*I4*d51');
h153 = trace(d553*I4*d51');
h154 = trace(d554*I4*d51');
h155 = trace(d555*I4*d51');

% For Joint 2
h211 = trace(d211*I2*d22') + trace(d311*I3*d32') + trace(d411*I15*d42') + trace(d511*I4*d52');
h212 = trace(d212*I2*d22') + trace(d312*I3*d32') + trace(d412*I15*d42') + trace(d512*I4*d52');
h213 = trace(d313*I3*d32') + trace(d413*I15*d42') + trace(d513*I4*d52');
h214 = trace(d414*I15*d42') + trace(d514*I4*d52');
h215 = trace(d515*I4*d52');

h221 = trace(d221*I2*d22') + trace(d321*I3*d32') + trace(d421*I15*d42') + trace(d521*I4*d52');
h222 = trace(d222*I2*d22') + trace(d322*I3*d32') + trace(d422*I15*d42') + trace(d522*I4*d52');
h223 = trace(d323*I3*d32') + trace(d423*I15*d42') + trace(523*I4*d52');
h224 = trace(d424*I15*d42') + trace(d524*I4*d52');
h225 = trace(d525*I4*d52');

h231 = trace(d331*I3*d32') + trace(d431*I15*d42') + trace(d531*I4*d52');
h232 = trace(d332*I3*d32') + trace(d432*I15*d42') + trace(d532*I4*d52');
h233 = trace(d333*I3*d32') + trace(d433*I15*d42') + trace(d533*I4*d52');
h234 = trace(d434*I15*d42') + trace(d534*I4*d52');
h235 = trace(d535*I4*d52');

h241 = trace(d441*I15*d42') + trace(d541*I4*d52');
h242 = trace(d442*I15*d42') + trace(d542*I4*d52');
h243 = trace(d443*I15*d42') + trace(d543*I4*d52');
h244 = trace(d444*I15*d42') + trace(d544*I4*d52');
h245 = trace(d545*I4*d52');

h251 = trace(d551*I4*d52');
h252 = trace(d552*I4*d52');
h253 = trace(d553*I4*d52');
h254 = trace(d554*I4*d52');
h255 = trace(d555*I4*d52');

% For Joint 3
h311 = trace(d311*I3*d33') + trace(d411*I15*d43') + trace(d511*I4*d53');
h312 = trace(d312*I3*d33') + trace(d412*I15*d43') + trace(d512*I4*d53');
h313 = trace(d313*I3*d33') + trace(d413*I15*d43') + trace(d513*I4*d53');
h314 = trace(d414*I15*d43') + trace(d514*I4*d53');
h315 = trace(d515*I4*d53');

h321 = trace(d321*I3*d33') + trace(d421*I15*d43') + trace(d521*I4*d53');
h322 = trace(d322*I3*d33') + trace(d422*I15*d43') + trace(d522*I4*d53');
h323 = trace(d323*I3*d33') + trace(d423*I15*d43') + trace(d523*I4*d53');
h324 = trace(d424*I15*d43') + trace(d524*I4*d53');
h325 = trace(d525*I4*d53');

h331 = trace(d331*I3*d33') + trace(d431*I15*d43') + trace(d531*I4*d53');
h332 = trace(d332*I3*d33') + trace(d432*I15*d43') + trace(d532*I4*d53');
h333 = trace(d333*I3*d33') + trace(d433*I15*d43') + trace(d533*I4*d53');
h334 = trace(d434*I15*d43') + trace(d534*I4*d53');
h335 = trace(d535*I4*d53');

h341 = trace(d441*I15*d43') + trace(d541*I4*d53');
h342 = trace(d442*I15*d43') + trace(d542*I4*d53');
h343 = trace(d443*I15*d43') + trace(d543*I4*d53');
h344 = trace(d444*I15*d43') + trace(d544*I4*d53');
h345 = trace(d545*I4*d53');

h351 = trace(d551*I4*d53');
h352 = trace(d552*I4*d53');
h353 = trace(d553*I4*d53');
h354 = trace(d554*I4*d53');
h355 = trace(d555*I4*d53');

% For Joint 4
h411 = trace(d411*I15*d44') + trace(d511*I4*d54');
h412 = trace(d412*I15*d44') + trace(d512*I4*d54');
h413 = trace(d413*I15*d44') + trace(d513*I4*d54');
h414 = trace(d414*I15*d44') + trace(d514*I4*d54');
h415 = trace(d515*I4*d54');

h421 = trace(d421*I15*d44') + trace(d521*I4*d54');
h422 = trace(d422*I15*d44') + trace(d522*I4*d54');
h423 = trace(d423*I15*d44') + trace(d523*I4*d54');
h424 = trace(d424*I15*d44') + trace(d524*I4*d54');
h425 = trace(d525*I4*d54');

h431 = trace(d431*I15*d44') + trace(d531*I4*d54');
h432 = trace(d432*I15*d44') + trace(d532*I4*d54');
h433 = trace(d433*I15*d44') + trace(d533*I4*d54');
h434 = trace(d434*I15*d44') + trace(d534*I4*d54');
h435 = trace(d535*I4*d54');

h441 = trace(d441*I15*d44') + trace(d541*I4*d54);
h442 = trace(d442*I15*d44') + trace(d542*I4*d54');
h443 = trace(d443*I15*d44') + trace(d543*I4*d54');
h444 = trace(d444*I15*d44') + trace(d544*I4*d54');
h445 = trace(d545*I4*d54');

h451 = trace(d551*I4*d54');
h452 = trace(d552*I4*d54');
h453 = trace(d553*I4*d54');
h454 = trace(d554*I4*d54');
h455 = trace(d555*I4*d54');

% For Joint 5
h511 = trace(d511*I4*d54');
h512 = trace(d512*I4*d54');
h513 = trace(d513*I4*d54');
h514 = trace(d514*I4*d54');
h515 = trace(d515*I4*d54');

h521 = trace(d521*I4*d54');
h522 = trace(d522*I4*d54');
h523 = trace(d523*I4*d54');
h524 = trace(d524*I4*d54');
h525 = trace(d525*I4*d54');

h531 = trace(d531*I4*d54');
h532 = trace(d532*I4*d54');
h533 = trace(d533*I4*d54');
h534 = trace(d534*I4*d54');
h535 = trace(d535*I4*d54');

h541 = trace(d541*I4*d54);
h542 = trace(d542*I4*d54');
h543 = trace(d543*I4*d54');
h544 = trace(d544*I4*d54');
h545 = trace(d545*I4*d54');

h551 = trace(d551*I4*d54');
h552 = trace(d552*I4*d54');
h553 = trace(d553*I4*d54');
h554 = trace(d554*I4*d54');
h555 = trace(d555*I4*d54');

%% Step-9
% Computing the Gravity terms Gijk

g = 9.81;
g = [g 0 0 0];

% r01 - represents the centre of mass of the link i with respect to frame 0 and with respect to frame 1

% The mass of the links has been assumed to be concentrated at the centroid of the links

r11 = [-l1/2;0;0;1];
r22 = [-l2/2;0;0;1];
r33 = [-l3/2;0;0;1];
r44 = [-l15/2;0;0;1];
r55 = [-l4/2;0;0;1];

G1 = -(m1*g*d11*r11 + m2*g*d21*r22 + m3*g*d31*r33 + m15*g*d41*r44 + m4*g*d51*r55);
G2 = -(m2*g*d22*r22 + m3*g*d32*r33 + m15*g*d42*r44 + m4*g*d52*r55);
G3 = -(m3*g*d33*r33 + m15*g*d43*r44 + m4*g*d53*r55);
G15 = -(m15*g*d44*r44 + m4*g*d54*r55);
G4 = -(m4*g*d55*r55);
G = [G1; G2; G3; G15; G4];

%% Step-10
% Computing the Coriolis and centrifugal coefficient terms using the series summation

H1 = h111*omega1(1)*omega1(1) + h112*omega1(1)*omega1(2) + h113*omega1(1)*omega1(3) + h114*omega1(1)*omega1(15) + h115*omega1(1)*omega1(4) + h121*omega1(2)*omega1(1) + h122*omega1(2)*omega1(2) + h123*omega1(2)*omega1(3) + h124*omega1(2)*omega1(15) + h125*omega1(2)*omega1(4) + h131*omega1(3)*omega1(1) + h132*omega1(3)*omega1(2) + h133*omega1(3)*omega1(3) + h134*omega1(3)*omega1(15) + h135*omega1(3)*omega1(4) + h141*omega1(15)*omega1(1) + h142*omega1(15)*omega1(2) + h143*omega1(15)*omega1(3) + h144*omega1(15)*omega1(15) + h145*omega1(15)*omega1(4) + h151*omega1(4)*omega1(1) + h152*omega1(4)*omega1(2) + h153*omega1(4)*omega1(3) + h154*omega1(4)*omega1(15) + h155*omega1(4)*omega1(4);
H2 = h211*omega1(1)*omega1(1) + h212*omega1(1)*omega1(2) + h213*omega1(1)*omega1(3) + h214*omega1(1)*omega1(15) + h215*omega1(1)*omega1(4) + h221*omega1(2)*omega1(1) + h222*omega1(2)*omega1(2) + h223*omega1(2)*omega1(3) + h224*omega1(2)*omega1(15) + h225*omega1(2)*omega1(4) + h231*omega1(3)*omega1(1) + h232*omega1(3)*omega1(2) + h233*omega1(3)*omega1(3) + h234*omega1(3)*omega1(15) + h235*omega1(3)*omega1(4) + h241*omega1(15)*omega1(1) + h242*omega1(15)*omega1(2) + h243*omega1(15)*omega1(3) + h244*omega1(15)*omega1(15) + h245*omega1(15)*omega1(4) + h251*omega1(4)*omega1(1) + h252*omega1(4)*omega1(2) + h253*omega1(4)*omega1(3) + h254*omega1(4)*omega1(15) + h255*omega1(4)*omega1(4);
H3 = h311*omega1(1)*omega1(1) + h312*omega1(1)*omega1(2) + h313*omega1(1)*omega1(3) + h314*omega1(1)*omega1(15) + h315*omega1(1)*omega1(4) + h321*omega1(2)*omega1(1) + h322*omega1(2)*omega1(2) + h323*omega1(2)*omega1(3) + h324*omega1(2)*omega1(15) + h325*omega1(2)*omega1(4) + h331*omega1(3)*omega1(1) + h332*omega1(3)*omega1(2) + h333*omega1(3)*omega1(3) + h334*omega1(3)*omega1(15) + h335*omega1(3)*omega1(4) + h341*omega1(15)*omega1(1) + h342*omega1(15)*omega1(2) + h343*omega1(15)*omega1(3) + h344*omega1(15)*omega1(15) + h345*omega1(15)*omega1(4) + h351*omega1(4)*omega1(1) + h352*omega1(4)*omega1(2) + h353*omega1(4)*omega1(3) + h354*omega1(4)*omega1(15) + h355*omega1(4)*omega1(4);
H15 = h411*omega1(1)*omega1(1) + h412*omega1(1)*omega1(2) + h413*omega1(1)*omega1(3) + h414*omega1(1)*omega1(15) + h415*omega1(1)*omega1(4) + h421*omega1(2)*omega1(1) + h422*omega1(2)*omega1(2) + h423*omega1(2)*omega1(3) + h424*omega1(2)*omega1(15) + h425*omega1(2)*omega1(4) + h431*omega1(3)*omega1(1) + h432*omega1(3)*omega1(2) + h433*omega1(3)*omega1(3) + h434*omega1(3)*omega1(15) + h435*omega1(3)*omega1(4) + h441*omega1(15)*omega1(1) + h442*omega1(15)*omega1(2) + h443*omega1(15)*omega1(3) + h444*omega1(15)*omega1(15) + h445*omega1(15)*omega1(4) + h451*omega1(4)*omega1(1) + h452*omega1(4)*omega1(2) + h453*omega1(4)*omega1(3) + h454*omega1(4)*omega1(15) + h455*omega1(4)*omega1(4);
H4 = h511*omega1(1)*omega1(1) + h512*omega1(1)*omega1(2) + h513*omega1(1)*omega1(3) + h514*omega1(1)*omega1(15) + h515*omega1(1)*omega1(4) + h521*omega1(2)*omega1(1) + h522*omega1(2)*omega1(2) + h523*omega1(2)*omega1(3) + h524*omega1(2)*omega1(15) + h525*omega1(2)*omega1(4) + h531*omega1(3)*omega1(1) + h532*omega1(3)*omega1(2) + h533*omega1(3)*omega1(3) + h534*omega1(3)*omega1(15) + h535*omega1(3)*omega1(4) + h541*omega1(15)*omega1(1) + h542*omega1(15)*omega1(2) + h543*omega1(15)*omega1(3) + h544*omega1(15)*omega1(15) + h545*omega1(15)*omega1(4) + h551*omega1(4)*omega1(1) + h552*omega1(4)*omega1(2) + h553*omega1(4)*omega1(3) + h554*omega1(4)*omega1(15) + h555*omega1(4)*omega1(4);
H = [H1; H2; H3; H15; H4];

%% Step-11
% Computing the Torque at each joint

tau1(1,1) = (M11*alpha1(1) + M12*alpha1(2) + M13*alpha1(3) + M14*alpha1(15) + M15*alpha1(4)) + H1 + G1;
tau1(1,2) = (M21*alpha1(1) + M22*alpha1(2) + M23*alpha1(3) + M24*alpha1(15) + M25*alpha1(4)) + H2 + G2;
tau1(1,3) = (M31*alpha1(1) + M32*alpha1(2) + M33*alpha1(3) + M34*alpha1(15) + M35*alpha1(4)) + H3 + G3;
tau1(1,4) = (M41*alpha1(1) + M42*alpha1(2) + M43*alpha1(3) + M44*alpha1(15) + M45*alpha1(4)) + H15 + G15;
tau1(1,5) = (M51*alpha1(1) + M52*alpha1(2) + M53*alpha1(3) + M54*alpha1(15) + M55*alpha1(4)) + H4 + G4;

%% PID Control

% PID Parameters
kp1=kpid(1); kd1=kpid(2); ki1=kpid(3);           % for theta 1
kp2=kpid(4); kd2=kpid(5); ki2=kpid(6);           % for theta 2
kp3=kpid(7); kd3=kpid(8); ki3=kpid(9);           % for theta 3
kp15=kpid(10); kd15=kpid(11); ki15=kpid(12);     % for theta 15
kp4=kpid(13); kd4=kpid(14); ki4=kpid(15);        % for theta 4

% decoupled control input
f1=ki1*(x(1))+kp1*(th1s-x(6))-kd1*x(11);
f2=ki2*(x(2))+kp2*(th2s-x(7))-kd2*x(12);
f3=ki3*(x(3))+kp3*(th3s-x(8))-kd3*x(13);
f15=ki15*(x(4))+kp15*(th15s-x(9))-kd15*x(14);
f4=ki4*(x(5))+kp4*(th4s-x(10))-kd4*x(15);

Fhat = [f1;f2;f3;f15;f4];
F = M.*Fhat;

%% system states
xdot=zeros(20,1);
xdot(1)=(th1s-x(6));        % dummy state of theta1 integration
xdot(2)=(th2s-x(7));        % dummy state of theta2 integration
xdot(3)=(th3s-x(8));        % dummy state of theta3 integration
xdot(4)=(th15s-x(9));       % dummy state of theta15 integration
xdot(5)=(th4s-x(10));       % dummy state of theta4 integration

xdot(6)=x(11);              % theta1-dot
xdot(7)=x(12);              % theta2-dot
xdot(8)=x(13);              % theta3-dot
xdot(9)=x(14);              % theta15-dot
xdot(10)=x(15);             % theta4-dot

qdot=inv(M)*(F - H - G);
% qdot = (M)\(F - H - G);
xdot(11)=qdot(1);          % theta1-2dot
xdot(12)=qdot(2);          % theta2-2dot
xdot(13)=qdot(3);          % theta3-2dot
xdot(14)=qdot(4);          % theta4-2dot
xdot(15)=qdot(5);          % theta5-2dot

%control input function output to outside computer program
xdot(16)=F(1);
xdot(17)=F(2);
xdot(18)=F(3);
xdot(19)=F(4);
xdot(20)=F(5);